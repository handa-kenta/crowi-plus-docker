box: docker:stable


prepare-to-release: # would be run on release branch
  steps:
    - script:
      name: bump version
      code: |
        export NEW_APP_VERSION=$RELEASE_VERSION
        ./bin/bump-version.sh

    - script:
      name: push to github to create new branch
      code: |
        # git config --global user.name "wercker"
        # git config --global user.email "info@weseek.co.jp"
        # git commit -am ":+1: APP_VERSION"
        # # reconfigure origin
        # GITHUB_ORIGIN=https://yuki-takei:$GITHUB_TOKEN@$WERCKER_GIT_DOMAIN/$WERCKER_GIT_OWNER/$WERCKER_GIT_REPOSITORY.git
        # git remote set-url origin $GITHUB_ORIGIN
        # git checkout -B tmp/release-$RELEASE_VERSION
        # git push -u origin HEAD:tmp/release-$RELEASE_VERSION


# the pipeline that do nothing
#  this is needed while wercker can't detect specified branch pushed
empty:
  steps:
    - script:
      code: echo "this is $WERCKER_GIT_BRANCH branch"
