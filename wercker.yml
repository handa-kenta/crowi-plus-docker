box: node:6


release:
  steps:
    - script:
      name: bump version
      code: |
        NEW_APP_VERSION=v$RELEASE_VERSION sh ./bin/bump-version.sh

    - script:
      name: git commit
      code: |
        sh ./bin/init-git.sh
        git commit -am ":+1: version"

    # push HEAD to $WERCKER_GIT_BRANCH
    - script:
      name: push to github
      code: |
        git push -u origin HEAD:$WERCKER_GIT_BRANCH
        TARGET_COMMITISH=`git rev-parse HEAD`

    # create github release on HEAD
    - github-create-release:
      token: $GITHUB_TOKEN
      tag: v$RELEASE_VERSION
      target-commitish: $TARGET_COMMITISH
